<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CB POKER - DEBUG DONE</title>
    <style>
        body { background: #121212; color: white; text-align: center; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        #status { color: gold; font-size: 1.2rem; margin-bottom: 20px; }
        button { padding: 15px 30px; font-size: 1rem; background: #27ae60; color: white; border: none; border-radius: 8px; cursor: pointer; display: none; }
        .error { color: #ff4d4d; font-size: 14px; margin-top: 10px; }
    </style>
</head>
<body>

<div id="app">
    <div id="status">æ­£åœ¨å¯»æ‰¾æ¸¸æˆå¼•æ“...</div>
    <button id="start-btn" onclick="connect()">è¿›å…¥æ¸¸æˆ</button>
    <div id="debug" class="error"></div>
</div>

<script type="module">
    // æˆ‘ä»¬å°è¯•ä»ä¸‰ä¸ªä¸åŒçš„æºåŠ¨æ€å¯¼å…¥ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢
    const sources = [
        "https://cdn.skypack.dev/playroomkit",
        "https://cdn.jsdelivr.net/npm/playroomkit/dist/playroomkit.js",
        "https://esm.run/playroomkit"
    ];

    let PlayroomLib = null;

    async function loadEngine() {
        const debug = document.getElementById("debug");
        const status = document.getElementById("status");

        for (const src of sources) {
            try {
                console.log("æ­£åœ¨å°è¯•åŠ è½½:", src);
                const module = await import(src);
                // Playroom æœ‰æ—¶å¯¼å‡ºåœ¨ default ä¸­ï¼Œæœ‰æ—¶ç›´æ¥å¯¼å‡º
                PlayroomLib = module.default || module;
                
                if (PlayroomLib && PlayroomLib.insertCoin) {
                    status.innerText = "âœ… å¼•æ“å·²é”å®šï¼";
                    document.getElementById("start-btn").style.display = "inline-block";
                    return;
                }
            } catch (e) {
                console.warn(`æº ${src} å¤±è´¥ï¼Œå°è¯•ä¸‹ä¸€ä¸ª...`);
            }
        }
        status.innerText = "âŒ å¼•æ“åŠ è½½å¤±è´¥";
        debug.innerText = "åŸå› ï¼šæ‰€æœ‰ CDN æ¸ é“å‡æ— æ³•è®¿é—®ã€‚è¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œæ˜¯å¦å­˜åœ¨ç‰¹æ®Šçš„é˜²ç«å¢™è®¾ç½®ã€‚";
    }

    window.connect = async function() {
        try {
            await PlayroomLib.insertCoin({
                gameId: "cbpoker_2026_test",
                skipLobby: false
            });
            document.getElementById("status").innerText = "ğŸ‰ è”æœºæˆåŠŸï¼";
        } catch (err) {
            alert("è¿æ¥æœåŠ¡å™¨å¤±è´¥: " + err.message);
        }
    }

    loadEngine();
</script>
</body>
</html>
